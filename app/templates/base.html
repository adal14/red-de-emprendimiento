{% load staticfiles %}
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{% block title %}RD Emprende{% endblock title %}</title>

  <!-- CS -->

  <link rel="stylesheet" href="{{ STATIC_URL }}/css/bootstrap.css">
  <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
  <link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}/css/animation.css">
  <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,300,700' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}/css/style.css">

  {% block extra_css %}

  {% endblock extra_css %}
</head>

<body>

	<nav class="navbar navbar-default" id="navbar">
	  <div class="container-fluid">
	    <div class="navbar-header">
	      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse">
	        <span class="sr-only">Toggle navigation</span>
	        <span class="icon-bar"></span>
	        <span class="icon-bar"></span>
	        <span class="icon-bar"></span>
	      </button>
	       <a href="/" class="navbar-brand no-padding-logo"><img src="{{ STATIC_URL }}/img/logo.png" class="mobile-logo"></a>
	    </div>

	    <div class="collapse navbar-collapse" id="navbar-collapse">
	      <ul class="nav navbar-nav navbar-right text-center">
	          <li role="presentation"><a href="/category/inspira/">Inspira</a></li>
	          <li role="presentation"><a href="/category/crea/">Crea</a></li>
	          <li role="presentation"><a href="/category/guia/">Guia</a></li>
	          <li role="presentation"><a href="/category/conecta/">Conecta</a></li>
	          <li role="presentation"><a href="/category/capital/">Capital</a></li>
	          <li role="presentation"><a href="/calendar/">Eventos</a></li>

	         {% if user.is_authenticated %}
            <li role="presentation">
                <a class="dropdown-toggle login-link " type="button" id="dropdownMenu1" data-toggle="dropdown" aria-expanded="true">
                  Hola, {{ user.full_name }}
                  <span class="caret"></span>
                </a>
                <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">
                  <li role="presentation"><a role="menuitem" tabindex="-1" href="#">Eventos</a></li>
                  <li role="presentation"><a role="menuitem" tabindex="-1" href="/dashboard/">Perfil</a></li>
                  <li role="presentation"><a role="menuitem" tabindex="-1" href="/dashboard/">Cambiar contrase&ntilde;a</a></li>
                  <li role="presentation"><a role="menuitem" tabindex="-1" href="/accounts/logout/">Cerrar sesi&oacute;n</a></li>
                </ul>
            </li>

            {% else %}

            <li role="presentation"><a href="#" data-toggle="modal" data-target="#signin-modal">Iniciar Sesi&oacute;n</a></li>

            {% endif %}
	    </div><!-- /.navbar-collapse -->
	  </div><!-- /.container-fluid -->
	</nav>

	{% block content %}
	{% endblock content %}


<div class="modal fade" id="signin-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title">Iniciar Sesi&oacute;n</h4>
      </div>
      <div class="modal-body">
      	<p class="bg-danger hidden" id="signin_error_message"></p>
        <form action="/signin/" method="POST" id="signin-form">
        	{% csrf_token %}
        	<div class="form-group">
        		 <label>Email</label>
        		 {{ request.login_form.username }}
        	</div>
        	<div class="form-group">
        		 <label>Contrase&ntilde;a</label>
        		 {{ request.login_form.password }}
        	</div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" data-dismiss="modal">Cancelar</button>
        <button type="button" id="login-btn" class="btn btn-success">Iniciar Sesi&oacute;n</button>
      </div>
      </form>
    </div>
  </div>
</div>


	<div class="footer">
	  <div class="container">
	    <div class="row">
	      <div class="col-sm-4">
	        <a href="/"><img src="{{ STATIC_URL }}img/logow.png" class="big-logo"></a>
	      </div>
	    </div>
	  </div>
	</div>

	<div class="credits">
	  <div class="container">
	    <div class="row">
	      <div class="col-sm-12">
	        <p class="pull-right">Desarrollado por <a href="http://codetiger.co">Codetiger</a></p>
	      </div>
	    </div>
	  </div>
	</div>

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="{{ STATIC_URL }}/js/script.js"></script>
  {% if user.is_anonymous %}
    <script>
     var login = $('login-btn');

     login.click(
      function(event){
       event.preventDefault();
         $.ajax({
           url: '/signin/',
           data: $('login-form').serialize(),
           type: 'POST',
           success:
             function(result){
             if(is_loggedin == true){
              alert('user has been logged in');
             }else{
             alert('there was an error, please verify');
             }
           },
           error:
             function(){
              alert('some server error');
           },
         }); 
     });
    </script>
  {% endif %}
	{% block extra_js %}

	<script type="text/javascript">
		var link = $("#signin-btn");
 
		link.click(
		    function(event){
		        //eliminate the default function
		        event.preventDefault();
		        $.ajax({
		            url: '/signin/',
		            data:  $('#signin-form').serialize(), 
		            type: "POST",
		            success: 
		                function(result){
		                	 if (result.is_loggedin){
				                  window.location = "/";
				              } else {
				                $('#signin_error_message').html(result.reason).removeClass('hidden');
				              }
		                },
		            error: 
		                function(){
		                    alert("Estamos experimentando problemas, intente m√°s tarde.");
		                }
		        });
		});
	</script>
  {% endblock extra_js %}

</body>
</html>

